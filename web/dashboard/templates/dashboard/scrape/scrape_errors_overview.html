{% extends "dashboard/base.html" %}
{% load static %}
{% load pipeline %}
{% load dashboard_utils %}

{% block content %}

    <ul class="nav nav-tabs" id="myTab" role="tablist">
        {% for error_type in errors %}
            <li class="nav-item">
                <a class="nav-link {% if forloop.first %}active display{% endif %}" id="{{ forloop.counter0 }}-tab" data-toggle="tab" href="#error-list-{{ forloop.counter0 }}" role="tab"
                   aria-controls="error-list-{{ forloop.counter0 }}"
                   aria-selected="{% if forloop.first %}true{% else %}false{% endif %}">{{ error_type }}</a>
            </li>
        {% endfor %}

    </ul>


    <div class="container">

        <div class="tab-content" id="locationTabContent">
        {% for errors in errors.values %}
            <div class="tab-pane fade {% if forloop.first %}show active{% endif %}" id="error-list-{{ forloop.counter0 }}" role="tabpanel" aria-labelledby="{{ forloop.counter0 }}-tab">
                <div class="row">
                    {% for error in errors %}
                        <div class="col-12 p-2">
                            {% if error.paper %}
                                {% include 'dashboard/scrape/partials/_error_card.html' with error=error ref_paper=referenced_papers|get_item:error.paper.doi %}
                            {% else %}
                                {% include 'dashboard/scrape/partials/_error_card.html' with error=error%}
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endfor %}
    </div>
    <!----modal starts here--->
    <div id="deleteModal" class="modal fade" role='dialog'>
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                    <h4 class="modal-title">Delete </h4>
                </div>
                <div class="modal-body">
                    <p>Do You Really Want to Delete This ?</p>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <span id= 'deleteButton'></span>
                </div>

            </div>
          </div>
      </div>
    <!--Modal ends here--->
{% endblock %}

{% block script %}
<script>

    function confirmDeleteModal(id){
        $('#deleteModal').modal();
        $('#deleteButton').html('<form method="post">{% csrf_token %}<input type="hidden" name="id" value='+id+'><button type="submit" class="btn btn-danger">Delete</button></form>');
        $("#successMessage").html("Record With id "+id+" Deleted successfully!");
        $('#deleteModal').modal('hide'); // now close modal
    }
</script>
{% endblock %}